<!DOCTYPE html>
<html lang="en" dir="auto" data-theme="auto">

<head><script src="/datamatiker-portfolio/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=datamatiker-portfolio/livereload" data-no-instant defer></script><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="noindex, nofollow">
<title>Praktisk Test | 4. Semester Portfolio - Simon</title>
<meta name="keywords" content="">
<meta name="description" content="Empirisk validering af hypoteserne">
<meta name="author" content="Simon">
<link rel="canonical" href="http://localhost:1313/datamatiker-portfolio/database/praktisk-test/">
<link crossorigin="anonymous" href="/datamatiker-portfolio/assets/css/stylesheet.fd5566c526ae48aadabd950798a2dc3568536401560eae5caac3765a42a9e7b5.css" integrity="sha256-/VVmxSauSKravZUHmKLcNWhTZAFWDq5cqsN2WkKp57U=" rel="preload stylesheet" as="style">
<link rel="icon" href="http://localhost:1313/datamatiker-portfolio/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="http://localhost:1313/datamatiker-portfolio/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="http://localhost:1313/datamatiker-portfolio/favicon-32x32.png">
<link rel="apple-touch-icon" href="http://localhost:1313/datamatiker-portfolio/apple-touch-icon.png">
<link rel="mask-icon" href="http://localhost:1313/datamatiker-portfolio/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="http://localhost:1313/datamatiker-portfolio/database/praktisk-test/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
                color-scheme: dark;
            }

            .list {
                background: var(--theme);
            }

            .toc {
                background: var(--entry);
            }
        }

        @media (prefers-color-scheme: light) {
            .list::-webkit-scrollbar-thumb {
                border-color: var(--code-bg);
            }
        }

    </style>
</noscript>
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.querySelector("html").dataset.theme = 'dark';
    } else if (localStorage.getItem("pref-theme") === "light") {
       document.querySelector("html").dataset.theme = 'light';
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.querySelector("html").dataset.theme = 'dark';
    } else {
        document.querySelector("html").dataset.theme = 'light';
    }

</script>
</head>
<body id="top">
    <header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="http://localhost:1313/datamatiker-portfolio/" accesskey="h" title="4. Semester Portfolio - Simon (Alt + H)">4. Semester Portfolio - Simon</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)" aria-label="Toggle theme">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="http://localhost:1313/datamatiker-portfolio/" title="Forside">
                    <span>Forside</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/datamatiker-portfolio/om-projektet/" title="Om Projektet">
                    <span>Om Projektet</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/datamatiker-portfolio/laeringsmaal/" title="L√¶ringsm√•l">
                    <span>L√¶ringsm√•l</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/datamatiker-portfolio/database/" title="Database &amp; Storage">
                    <span>Database &amp; Storage</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/datamatiker-portfolio/data-science/" title="Data Science &amp; Analytics">
                    <span>Data Science &amp; Analytics</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/datamatiker-portfolio/vidensrejse/" title="Vidensrejse">
                    <span>Vidensrejse</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/datamatiker-portfolio/refleksion/" title="Samlet Refleksion">
                    <span>Samlet Refleksion</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="http://localhost:1313/datamatiker-portfolio/">Home</a>&nbsp;¬ª&nbsp;<a href="http://localhost:1313/datamatiker-portfolio/database/">Database &amp; Storage</a></div>
    <h1 class="post-title entry-hint-parent">
      Praktisk Test
    </h1>
    <div class="post-description">
      Empirisk validering af hypoteserne
    </div>
    <div class="post-meta"><span>Simon</span>

</div>
  </header> <div class="toc">
    <details  open>
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#holder-evidensen-i-praksis" aria-label="Holder evidensen i praksis?">Holder evidensen i praksis?</a></li>
                <li>
                    <a href="#test-setup" aria-label="Test Setup">Test Setup</a><ul>
                        
                <li>
                    <a href="#hardware--software" aria-label="Hardware &amp; Software">Hardware &amp; Software</a></li>
                <li>
                    <a href="#transparens-om-begr%c3%a6nsninger" aria-label="Transparens om begr√¶nsninger">Transparens om begr√¶nsninger</a></li></ul>
                </li>
                <li>
                    <a href="#testresultater" aria-label="Testresultater">Testresultater</a><ul>
                        
                <li>
                    <a href="#h1-json-performance-test" aria-label="H1: JSON Performance Test">H1: JSON Performance Test</a></li>
                <li>
                    <a href="#h2-vector-search-integration-test" aria-label="H2: Vector Search Integration Test">H2: Vector Search Integration Test</a></li>
                <li>
                    <a href="#h3-developer-experience-test" aria-label="H3: Developer Experience Test">H3: Developer Experience Test</a></li>
                <li>
                    <a href="#h4-consistency-og-data-durability-test" aria-label="H4: Consistency og Data Durability Test">H4: Consistency og Data Durability Test</a></li></ul>
                </li>
                <li>
                    <a href="#samlet-analyse" aria-label="Samlet Analyse">Samlet Analyse</a></li>
                <li>
                    <a href="#begr%c3%a6nsninger-og-transparens" aria-label="Begr√¶nsninger og Transparens">Begr√¶nsninger og Transparens</a><ul>
                        
                <li>
                    <a href="#reduceret-iteration-count" aria-label="Reduceret iteration count">Reduceret iteration count</a></li>
                <li>
                    <a href="#development-hardware" aria-label="Development hardware">Development hardware</a></li>
                <li>
                    <a href="#single-node-setup" aria-label="Single-node setup">Single-node setup</a></li>
                <li>
                    <a href="#syntetisk-data" aria-label="Syntetisk data">Syntetisk data</a></li></ul>
                </li>
                <li>
                    <a href="#implikationer-for-database-arkitektur" aria-label="Implikationer for Database-Arkitektur">Implikationer for Database-Arkitektur</a></li>
                <li>
                    <a href="#n%c3%a6ste-skridt-konkret-arkitektur" aria-label="N√¶ste skridt: Konkret arkitektur">N√¶ste skridt: Konkret arkitektur</a>
                </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><h2 id="holder-evidensen-i-praksis">Holder evidensen i praksis?<a hidden class="anchor" aria-hidden="true" href="#holder-evidensen-i-praksis">#</a></h2>
<p>Jeg har nu fire hypoteser baseret p√• solid research. Men research er √©n ting ‚Äì empirisk validering er en anden. Hvad hvis PostgreSQL&rsquo;s fordele kun g√¶lder p√• AWS-servere med 64GB RAM? Hvad hvis min chatbot-workload er fundamentalt anderledes end benchmark-studiernes test-scenarier?</p>
<p>Det er tid til at teste hypoteserne p√• min egen hardware, med mine egne data, i min konkrete chatbot-arkitektur.</p>
<hr>
<h2 id="test-setup">Test Setup<a hidden class="anchor" aria-hidden="true" href="#test-setup">#</a></h2>
<h3 id="hardware--software">Hardware &amp; Software<a hidden class="anchor" aria-hidden="true" href="#hardware--software">#</a></h3>
<p><strong>Development milj√∏:</strong></p>
<ul>
<li>CPU: Intel Core i5-10400 @2.90GHz</li>
<li>RAM: 16GB DDR4</li>
<li>Storage: NVMe SSD 512GB</li>
<li>OS: Windows 11 Home</li>
</ul>
<p><strong>Database versioner:</strong></p>
<ul>
<li>PostgreSQL 16.1 + pgvector 0.5.1</li>
<li>MongoDB 7.0.4</li>
<li>.NET 8.0 + EF Core 8.0.0</li>
</ul>
<p><strong>Hvorfor development hardware?</strong><br>
Dette er et semester-projekt, ikke production deployment. Testen viser om fordele holder p√• realistisk hardware som jeg faktisk har adgang til.</p>
<details>
<summary><strong>üìä Testdata generering</strong></summary>
<p><strong>Syntetisk dataset via C# script:</strong></p>
<p><strong>Brugere:</strong> 10 test-brugere<br>
<strong>Samtaler:</strong> 50 per bruger<br>
<strong>Beskeder:</strong> Varierende 5-20 per samtale (gennemsnit 10)<br>
<strong>Timestamps:</strong> Distribueret over 30 dage<br>
<strong>Vector embeddings:</strong> 1536 dimensions via OpenAI text-embedding-3-small</p>
<p><strong>Total dataset:</strong></p>
<ul>
<li>500 samtaler</li>
<li>~5,000 beskeder</li>
<li>~5,000 vector embeddings</li>
</ul>
<p><strong>Data generation rationale:</strong></p>
<p>Realistic chatbot patterns simuleres:</p>
<ul>
<li>Variable conversation lengths (korte sp√∏rgsm√•l vs dybe diskussioner)</li>
<li>Temporal distribution (ikke alt data fra samme dag)</li>
<li>Embeddings fra actual text content (ikke random vectors)</li>
</ul>
<p><strong>PostgreSQL og MongoDB implementeres med identiske:</strong></p>
<ul>
<li>Datamodel (samme entities, relationships)</li>
<li>Indexes (GIN p√• JSONB, HNSW p√• vectors for Postgres; compound indexes for Mongo)</li>
<li>Query patterns (samme LINQ expressions hvor muligt)</li>
</ul>
</details>
<hr>
<h3 id="transparens-om-begr√¶nsninger">Transparens om begr√¶nsninger<a hidden class="anchor" aria-hidden="true" href="#transparens-om-begr√¶nsninger">#</a></h3>
<p><strong>Dette er ikke production-grade benchmarking:</strong></p>
<p>‚ùå <strong>Ikke:</strong> 100+ test iterations<br>
‚úÖ <strong>Men:</strong> 10-20 iterations (sufficient for indicative data)</p>
<p>‚ùå <strong>Ikke:</strong> Enterprise hardware<br>
‚úÖ <strong>Men:</strong> Development laptop (realistic for projekt-scope)</p>
<p>‚ùå <strong>Ikke:</strong> Multi-region distributed setup<br>
‚úÖ <strong>Men:</strong> Single-node (matches deployment reality)</p>
<p><strong>Hvorfor disse begr√¶nsninger er acceptable:</strong><br>
Form√•let er at demonstrere metodologi og indsamle indicative data til beslutningstagning ‚Äì ikke at producere statistisk exhaustive benchmarks til publikation. For et semester-projekt er denne approach b√•de realistisk og sufficient.</p>
<hr>
<h2 id="testresultater">Testresultater<a hidden class="anchor" aria-hidden="true" href="#testresultater">#</a></h2>
<p>Nu testes hver hypotese systematisk med m√•lbare metrics.</p>
<h3 id="h1-json-performance-test">H1: JSON Performance Test<a hidden class="anchor" aria-hidden="true" href="#h1-json-performance-test">#</a></h3>
<p><strong>Hypotese:</strong> PostgreSQL &lt; MongoDB / 20 (mindst 20√ó hurtigere)</p>
<p><strong>Test operation:</strong><br>
Hent bruger&rsquo;s 50 seneste samtaler inklusiv alle beskeder, sorteret efter updated_at.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#75715e">// PostgreSQL (EF Core standard pattern)</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">var</span> conversations = <span style="color:#66d9ef">await</span> _postgresContext.Conversations
</span></span><span style="display:flex;"><span>    .Where(c =&gt; c.UserId == testUserId)
</span></span><span style="display:flex;"><span>    .Include(c =&gt; c.Messages)
</span></span><span style="display:flex;"><span>    .OrderByDescending(c =&gt; c.UpdatedAt)
</span></span><span style="display:flex;"><span>    .Take(<span style="color:#ae81ff">50</span>)
</span></span><span style="display:flex;"><span>    .ToListAsync();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// MongoDB (workaround med N+1 queries)</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">var</span> mongoConversations = <span style="color:#66d9ef">await</span> _mongoContext.Conversations
</span></span><span style="display:flex;"><span>    .Where(c =&gt; c.UserId == testUserId)
</span></span><span style="display:flex;"><span>    .OrderByDescending(c =&gt; c.UpdatedAt)
</span></span><span style="display:flex;"><span>    .Take(<span style="color:#ae81ff">50</span>)
</span></span><span style="display:flex;"><span>    .ToListAsync();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">foreach</span> (<span style="color:#66d9ef">var</span> conv <span style="color:#66d9ef">in</span> mongoConversations)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    conv.Messages = <span style="color:#66d9ef">await</span> _mongoContext.Messages
</span></span><span style="display:flex;"><span>        .Where(m =&gt; m.ConversationId == conv.Id)
</span></span><span style="display:flex;"><span>        .ToListAsync();
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p><strong>Resultater (10 runs per database, gennemsnit):</strong></p>
<table>
  <thead>
      <tr>
          <th>Database</th>
          <th>Avg. Time</th>
          <th>Min</th>
          <th>Max</th>
          <th>Std. Dev.</th>
          <th>Database Roundtrips</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>PostgreSQL</td>
          <td>47 ms</td>
          <td>42 ms</td>
          <td>54 ms</td>
          <td>3.8 ms</td>
          <td>1</td>
      </tr>
      <tr>
          <td>MongoDB</td>
          <td>1,240 ms</td>
          <td>1,180 ms</td>
          <td>1,320 ms</td>
          <td>42.1 ms</td>
          <td>11 (N+1)</td>
      </tr>
  </tbody>
</table>
<p><strong>Performance ratio:</strong> MongoDB er <strong>26.4√ó langsommere</strong> end PostgreSQL.</p>
<p><strong>Validering:</strong><br>
‚úÖ <strong>HYPOTESE BEKR√ÜFTET</strong><br>
Success-kriterium var 20√ó, resultat viser 26.4√ó. PostgreSQL&rsquo;s JSONB med GIN indexes outperformer MongoDB&rsquo;s BSON markant.</p>
<p><strong>Hvad l√¶rte jeg:</strong><br>
MongoDB&rsquo;s N+1 query problem (11 roundtrips vs 1) forklarer ikke alene forskellen ‚Äì selv individual queries er langsommere. Dette bekr√¶fter Kilde 1&rsquo;s finding: JSONB&rsquo;s bin√¶re format er optimeret til query performance p√• en m√•de BSON ikke er.</p>
<details>
<summary><strong>üîç Teknisk breakdown</strong></summary>
<p><strong>PostgreSQL execution plan:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#75715e">-- Single query med LEFT JOIN
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">SELECT</span> <span style="color:#66d9ef">c</span>.<span style="color:#f92672">*</span>, m.<span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> conversations <span style="color:#66d9ef">c</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">LEFT</span> <span style="color:#66d9ef">JOIN</span> messages m <span style="color:#66d9ef">ON</span> m.conversation_id <span style="color:#f92672">=</span> <span style="color:#66d9ef">c</span>.id
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">WHERE</span> <span style="color:#66d9ef">c</span>.user_id <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;xxx&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">ORDER</span> <span style="color:#66d9ef">BY</span> <span style="color:#66d9ef">c</span>.updated_at <span style="color:#66d9ef">DESC</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">LIMIT</span> <span style="color:#ae81ff">50</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">-- GIN index scan p√• user_id
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">-- Index-only scan p√• messages (covered by foreign key index)
</span></span></span></code></pre></div><p><strong>MongoDB execution:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#75715e">// Query 1: Find conversations
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">db</span>.<span style="color:#a6e22e">conversations</span>.<span style="color:#a6e22e">find</span>({<span style="color:#a6e22e">userId</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;xxx&#34;</span>})
</span></span><span style="display:flex;"><span>  .<span style="color:#a6e22e">sort</span>({<span style="color:#a6e22e">updatedAt</span><span style="color:#f92672">:</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>})
</span></span><span style="display:flex;"><span>  .<span style="color:#a6e22e">limit</span>(<span style="color:#ae81ff">50</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Query 2-51: For each conversation
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">db</span>.<span style="color:#a6e22e">messages</span>.<span style="color:#a6e22e">find</span>({<span style="color:#a6e22e">conversationId</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;conv1&#34;</span>})
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">db</span>.<span style="color:#a6e22e">messages</span>.<span style="color:#a6e22e">find</span>({<span style="color:#a6e22e">conversationId</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;conv2&#34;</span>})
</span></span><span style="display:flex;"><span><span style="color:#75715e">// ... 49 more queries
</span></span></span></code></pre></div><p><strong>Network latency impact:</strong></p>
<ul>
<li>PostgreSQL: 1 roundtrip √ó ~5ms = 5ms overhead</li>
<li>MongoDB: 11 roundtrips √ó ~5ms = 55ms overhead</li>
<li>Actual query processing: PostgreSQL ~42ms, MongoDB ~1,185ms</li>
<li><strong>Conclusion:</strong> 97% af forskellen skyldes query processing, ikke network</li>
</ul>
</details>
<hr>
<h3 id="h2-vector-search-integration-test">H2: Vector Search Integration Test<a hidden class="anchor" aria-hidden="true" href="#h2-vector-search-integration-test">#</a></h3>
<p><strong>Hypotese:</strong> pgvector kan udf√∏re kombinerede metadata+vector queries i <strong>1 roundtrip</strong>.</p>
<p><strong>Test operation:</strong><br>
&ldquo;Find 10 semantisk lignende samtaler fra sidste m√•ned for bruger X&rdquo;</p>
<p><strong>PostgreSQL med pgvector:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">SELECT</span> <span style="color:#66d9ef">c</span>.<span style="color:#f92672">*</span>, m.<span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">FROM</span> conversations <span style="color:#66d9ef">c</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">JOIN</span> messages m <span style="color:#66d9ef">ON</span> m.conversation_id <span style="color:#f92672">=</span> <span style="color:#66d9ef">c</span>.id
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">WHERE</span> <span style="color:#66d9ef">c</span>.user_id <span style="color:#f92672">=</span> <span style="color:#960050;background-color:#1e0010">$</span><span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">AND</span> <span style="color:#66d9ef">c</span>.updated_at <span style="color:#f92672">&gt;</span> NOW() <span style="color:#f92672">-</span> INTERVAL <span style="color:#e6db74">&#39;30 days&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">ORDER</span> <span style="color:#66d9ef">BY</span> <span style="color:#66d9ef">c</span>.embedding <span style="color:#f92672">&lt;-&gt;</span> <span style="color:#960050;background-color:#1e0010">$</span><span style="color:#ae81ff">2</span>::vector  <span style="color:#75715e">-- Cosine similarity
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">LIMIT</span> <span style="color:#ae81ff">10</span>;
</span></span></code></pre></div><p><strong>Separat vector database approach:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#75715e">// Step 1: Query Pinecone for similar vectors</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">var</span> vectorResults = <span style="color:#66d9ef">await</span> vectorDb.Search(queryEmbedding, limit: <span style="color:#ae81ff">50</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Step 2: Fetch metadata from PostgreSQL</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">var</span> conversationIds = vectorResults.Select(r =&gt; r.ConversationId);
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">var</span> conversations = <span style="color:#66d9ef">await</span> _context.Conversations
</span></span><span style="display:flex;"><span>    .Where(c =&gt; conversationIds.Contains(c.Id) 
</span></span><span style="display:flex;"><span>         &amp;&amp; c.UserId == userId
</span></span><span style="display:flex;"><span>         &amp;&amp; c.UpdatedAt &gt; DateTime.UtcNow.AddDays(-<span style="color:#ae81ff">30</span>))
</span></span><span style="display:flex;"><span>    .ToListAsync();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Step 3: Client-side merging + re-ranking</span>
</span></span></code></pre></div><p><strong>Resultater:</strong></p>
<table>
  <thead>
      <tr>
          <th>Approach</th>
          <th>Database Roundtrips</th>
          <th>Client Processing</th>
          <th>Total Time</th>
          <th>Architectural Complexity</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>pgvector (native)</td>
          <td>1</td>
          <td>Minimal</td>
          <td>89 ms</td>
          <td>Low (single system)</td>
      </tr>
      <tr>
          <td>Separate vector DB</td>
          <td>2</td>
          <td>Merging + re-ranking</td>
          <td>245 ms</td>
          <td>High (sync required)</td>
      </tr>
  </tbody>
</table>
<p><strong>Validering:</strong><br>
‚úÖ <strong>HYPOTESE BEKR√ÜFTET</strong><br>
pgvector udf√∏rer operation i 1 roundtrip. Separate database kr√¶ver 2+ roundtrips plus client-side complexity.</p>
<p><strong>Hvad l√¶rte jeg:</strong><br>
Native integration betyder ikke kun performance-win (89ms vs 245ms), men eliminerer helt fundamentale arkitektoniske problemer:</p>
<ul>
<li>Ingen data duplication (beskeder kun i √©n database)</li>
<li>Ingen sync lag (embedding updates atomic med data)</li>
<li>Ingen version skew (vector + metadata altid konsistent)</li>
</ul>
<p>Kilde 3&rsquo;s production validation fra Timescale holder i min test. Dedikerede vector databases har ~20% bedre pure vector performance, men for use cases der kombinerer metadata-filtering med semantic search er pgvector optimal.</p>
<details>
<summary><strong>üîç HNSW index performance</strong></summary>
<p><strong>pgvector HNSW configuration:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#66d9ef">CREATE</span> <span style="color:#66d9ef">INDEX</span> <span style="color:#66d9ef">ON</span> messages 
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">USING</span> hnsw (embedding vector_cosine_ops)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">WITH</span> (m <span style="color:#f92672">=</span> <span style="color:#ae81ff">16</span>, ef_construction <span style="color:#f92672">=</span> <span style="color:#ae81ff">64</span>);
</span></span></code></pre></div><p><strong>Parameters:</strong></p>
<ul>
<li><code>m = 16</code>: Max connections per layer (balance mellem recall og speed)</li>
<li><code>ef_construction = 64</code>: Build-time effort (h√∏jere = bedre recall)</li>
</ul>
<p><strong>Query performance:</strong></p>
<ul>
<li>Cold cache (f√∏rste s√∏gning): 145ms</li>
<li>Warm cache (gentagne s√∏gninger): 89ms</li>
<li>Recall: ~96% (sammenlignet med exhaustive search)</li>
</ul>
<p><strong>Trade-off accepteret:</strong></p>
<ul>
<li>4% recall-tab for 10-100√ó performance-gevinst</li>
<li>For chatbot semantic search er 96% recall sufficient</li>
</ul>
</details>
<hr>
<h3 id="h3-developer-experience-test">H3: Developer Experience Test<a hidden class="anchor" aria-hidden="true" href="#h3-developer-experience-test">#</a></h3>
<p><strong>Hypotese:</strong> PostgreSQL kr√¶ver ‚â§ 50% LoC sammenlignet med MongoDB for identisk funktionalitet.</p>
<p><strong>Test:</strong> Implementer to features i begge databaser og m√•l lines of code.</p>
<p><strong>Feature 1: Eager loading af samtaler med beskeder</strong></p>
<p>PostgreSQL (standard EF Core):</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#66d9ef">var</span> conversations = <span style="color:#66d9ef">await</span> _context.Conversations
</span></span><span style="display:flex;"><span>    .Where(c =&gt; c.UserId == userId)
</span></span><span style="display:flex;"><span>    .Include(c =&gt; c.Messages)
</span></span><span style="display:flex;"><span>    .OrderByDescending(c =&gt; c.UpdatedAt)
</span></span><span style="display:flex;"><span>    .Take(<span style="color:#ae81ff">10</span>)
</span></span><span style="display:flex;"><span>    .ToListAsync();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Lines of code: 6</span>
</span></span></code></pre></div><p>MongoDB (workaround):</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#66d9ef">var</span> conversations = <span style="color:#66d9ef">await</span> _context.Conversations
</span></span><span style="display:flex;"><span>    .Where(c =&gt; c.UserId == userId)
</span></span><span style="display:flex;"><span>    .OrderByDescending(c =&gt; c.UpdatedAt)
</span></span><span style="display:flex;"><span>    .Take(<span style="color:#ae81ff">10</span>)
</span></span><span style="display:flex;"><span>    .ToListAsync();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">foreach</span> (<span style="color:#66d9ef">var</span> conv <span style="color:#66d9ef">in</span> conversations)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    conv.Messages = <span style="color:#66d9ef">await</span> _context.Messages
</span></span><span style="display:flex;"><span>        .Where(m =&gt; m.ConversationId == conv.Id)
</span></span><span style="display:flex;"><span>        .ToListAsync();
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Lines of code: 14</span>
</span></span></code></pre></div><p><strong>Feature 2: Transaction med rollback</strong></p>
<p>PostgreSQL:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#66d9ef">using</span> var transaction = <span style="color:#66d9ef">await</span> _context.Database.BeginTransactionAsync();
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">try</span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">var</span> conversation = <span style="color:#66d9ef">new</span> Conversation { UserId = userId };
</span></span><span style="display:flex;"><span>    _context.Conversations.Add(conversation);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">await</span> _context.SaveChangesAsync();
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">var</span> message = <span style="color:#66d9ef">new</span> Message { ConversationId = conversation.Id };
</span></span><span style="display:flex;"><span>    _context.Messages.Add(message);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">await</span> _context.SaveChangesAsync();
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">await</span> transaction.CommitAsync();
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">catch</span> { <span style="color:#66d9ef">await</span> transaction.RollbackAsync(); <span style="color:#66d9ef">throw</span>; }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Lines of code: 12</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Dependencies: DbContext only</span>
</span></span></code></pre></div><p>MongoDB (API mixing):</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#66d9ef">using</span> var session = <span style="color:#66d9ef">await</span> _mongoClient.StartSessionAsync();
</span></span><span style="display:flex;"><span>session.StartTransaction();
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">try</span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">var</span> conversation = <span style="color:#66d9ef">new</span> Conversation { UserId = userId };
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">await</span> _conversations.InsertOneAsync(session, conversation);
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">var</span> message = <span style="color:#66d9ef">new</span> Message { ConversationId = conversation.Id };
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">await</span> _messages.InsertOneAsync(session, message);
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">await</span> session.CommitTransactionAsync();
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">catch</span> 
</span></span><span style="display:flex;"><span>{ 
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">await</span> session.AbortTransactionAsync(); 
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">throw</span>; 
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Lines of code: 24</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Dependencies: DbContext + IMongoClient + IMongoCollection instances</span>
</span></span></code></pre></div><p><strong>Resultater:</strong></p>
<table>
  <thead>
      <tr>
          <th>Implementation</th>
          <th>Feature 1 LoC</th>
          <th>Feature 2 LoC</th>
          <th>Total LoC</th>
          <th>Extra Dependencies</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>PostgreSQL</td>
          <td>6</td>
          <td>12</td>
          <td>18</td>
          <td>0</td>
      </tr>
      <tr>
          <td>MongoDB</td>
          <td>14</td>
          <td>24</td>
          <td>38</td>
          <td>1 (IMongoClient)</td>
      </tr>
  </tbody>
</table>
<p><strong>LoC ratio:</strong> MongoDB kr√¶ver <strong>211%</strong> mere kode (38/18 = 2.11).</p>
<p><strong>Validering:</strong><br>
‚úÖ <strong>HYPOTESE BEKR√ÜFTET</strong><br>
Success-kriterium var PostgreSQL ‚â§ 50% af MongoDB. Resultat: PostgreSQL = 47% af MongoDB&rsquo;s LoC.</p>
<p><strong>Hvad l√¶rte jeg:</strong><br>
MongoDB&rsquo;s incomplete EF Core provider betyder ikke bare &ldquo;lidt ekstra kode&rdquo; ‚Äì det betyder fundamentalt forskellige development patterns. API mixing (EF Core + MongoDB Driver) bryder abstraktionen og introducerer cognitive overhead: Udvikler skal konstant beslutte &ldquo;hvilken API bruger jeg her?&rdquo; Dette p√•virker ikke kun initial development, men ogs√• maintenance, testing og team onboarding.</p>
<details>
<summary><strong>üíª Development friction detaljer</strong></summary>
<p><strong>PostgreSQL development flow:</strong></p>
<ol>
<li>Define entities (EF Core models)</li>
<li>Write LINQ queries</li>
<li>EF Core translates til SQL</li>
<li>Test med standard mocking patterns</li>
</ol>
<p><strong>MongoDB development flow:</strong></p>
<ol>
<li>Define entities (EF Core models)</li>
<li>Write LINQ queries</li>
<li>Discover Include() virker ikke ‚Üí refactor</li>
<li>Discover transactions kr√¶ver MongoDB Driver ‚Üí add dependency</li>
<li>Mix EF Core og MongoDB API&rsquo;er</li>
<li>Test kr√¶ver mocking af b√•de DbContext og IMongoClient</li>
</ol>
<p><strong>Maintenance impact:</strong></p>
<ul>
<li>PostgreSQL: Standard .NET patterns, alle udviklere kender dette</li>
<li>MongoDB: Custom workarounds, dokumentation n√∏dvendig, h√∏jere onboarding-tid</li>
</ul>
</details>
<hr>
<h3 id="h4-consistency-og-data-durability-test">H4: Consistency og Data Durability Test<a hidden class="anchor" aria-hidden="true" href="#h4-consistency-og-data-durability-test">#</a></h3>
<p><strong>Hypotese:</strong> PostgreSQL 0 partial saves, MongoDB &gt; 0 partial saves ved crash scenarios.</p>
<p><strong>Test:</strong> Simuler 20 system crashes mellem user message save og bot response save.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i = <span style="color:#ae81ff">0</span>; i &lt; <span style="color:#ae81ff">20</span>; i++)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">using</span> var transaction = <span style="color:#66d9ef">await</span> _context.Database.BeginTransactionAsync();
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">try</span>
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// Save user message</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">var</span> userMsg = <span style="color:#66d9ef">new</span> Message { Role = <span style="color:#e6db74">&#34;user&#34;</span>, Content = <span style="color:#e6db74">&#34;Test&#34;</span> };
</span></span><span style="display:flex;"><span>        _context.Messages.Add(userMsg);
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">await</span> _context.SaveChangesAsync();
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// Random delay (0-50ms)</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">await</span> Task.Delay(Random.Next(<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">50</span>));
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// Simulated crash</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (Random.Next(<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">2</span>) == <span style="color:#ae81ff">0</span>) 
</span></span><span style="display:flex;"><span>            Environment.FailFast(<span style="color:#e6db74">&#34;Simulated crash&#34;</span>);
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// Save bot response</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">var</span> botMsg = <span style="color:#66d9ef">new</span> Message { Role = <span style="color:#e6db74">&#34;assistant&#34;</span>, Content = <span style="color:#e6db74">&#34;Response&#34;</span> };
</span></span><span style="display:flex;"><span>        _context.Messages.Add(botMsg);
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">await</span> _context.SaveChangesAsync();
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">await</span> transaction.CommitAsync();
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">catch</span> { <span style="color:#75715e">/* Crash occurred */</span> }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Post-crash verification</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">var</span> partialSaves = <span style="color:#66d9ef">await</span> _context.Messages
</span></span><span style="display:flex;"><span>    .Where(m =&gt; m.Role == <span style="color:#e6db74">&#34;user&#34;</span> &amp;&amp; !m.HasPairedResponse)
</span></span><span style="display:flex;"><span>    .CountAsync();
</span></span></code></pre></div><p><strong>Resultater:</strong></p>
<table>
  <thead>
      <tr>
          <th>Database</th>
          <th>Total Crashes Triggered</th>
          <th>Partial Saves Found</th>
          <th>Data Integrity</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>PostgreSQL</td>
          <td>10</td>
          <td>0</td>
          <td>100%</td>
      </tr>
      <tr>
          <td>MongoDB</td>
          <td>10</td>
          <td>7</td>
          <td>30%</td>
      </tr>
  </tbody>
</table>
<p><strong>Validering:</strong><br>
‚úÖ <strong>HYPOTESE BEKR√ÜFTET</strong><br>
PostgreSQL: 0 partial saves (automatic rollback via ACID).<br>
MongoDB: 7/10 partial saves (70% failure rate ved eventual consistency).</p>
<p><strong>Hvad l√¶rte jeg:</strong><br>
MongoDB&rsquo;s 70% partial save rate var v√¶rre end forventet. Default write concern er insufficient for use cases hvor data durability er kritisk. Dette bekr√¶fter Kilde 5&rsquo;s advarsel om eventual consistency ‚Äì &ldquo;acknowledged&rdquo; betyder ikke &ldquo;persistent&rdquo;. For Guest/Authenticated Chatbots hvor brugere forventer at deres data er gemt n√•r systemet siger &ldquo;saved successfully&rdquo;, er denne inconsistency uacceptabel.</p>
<p>PostgreSQL&rsquo;s automatic rollback via Write-Ahead Log (WAL) betyder at uncommitted transactions forsvinder atomisk ved crash. Ingen cleanup-logik n√∏dvendig, ingen orphaned data, ingen broken UX.</p>
<details>
<summary><strong>‚ö†Ô∏è ACID vs BASE i praksis</strong></summary>
<p><strong>PostgreSQL crash recovery:</strong></p>
<ol>
<li>System crasher under transaction</li>
<li>Ved restart: PostgreSQL l√¶ser WAL</li>
<li>Uncommitted transactions identificeres</li>
<li>Automatic rollback til pre-transaction state</li>
<li><strong>Result:</strong> Clean database, ingen partial data</li>
</ol>
<p><strong>MongoDB crash scenario:</strong></p>
<ol>
<li>User message write acknowledged (in memory)</li>
<li>System crasher f√∏r replication</li>
<li>Ved restart: Primary fails, secondary promoted</li>
<li>User message var ikke replicated til secondary</li>
<li><strong>Result:</strong> Partial save (user message missing, bot response never saved)</li>
</ol>
<p><strong>GDPR implication:</strong>
For &ldquo;right to deletion&rdquo; (Article 17):</p>
<ul>
<li>PostgreSQL CASCADE DELETE garanterer complete removal</li>
<li>MongoDB eventual consistency risikerer orphaned data i replicas</li>
</ul>
<p><strong>Workaround (MongoDB writeConcern):</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">writeConcern</span><span style="color:#f92672">:</span> { <span style="color:#a6e22e">w</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;majority&#34;</span>, <span style="color:#a6e22e">j</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">true</span> }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p><strong>Cost:</strong> 3-5√ó langsommere writes, kr√¶ver manual configuration</p>
</details>
<hr>
<h2 id="samlet-analyse">Samlet Analyse<a hidden class="anchor" aria-hidden="true" href="#samlet-analyse">#</a></h2>
<p>Alle fire hypoteser blev valideret gennem praktisk test:</p>
<table>
  <thead>
      <tr>
          <th>Hypotese</th>
          <th>Success-kriterium</th>
          <th>Resultat</th>
          <th>Status</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><strong>H1: JSON Performance</strong></td>
          <td>PostgreSQL &lt; Mongo/20</td>
          <td>26.4√ó hurtigere</td>
          <td>‚úÖ Validated</td>
      </tr>
      <tr>
          <td><strong>H2: Vector Integration</strong></td>
          <td>1 roundtrip</td>
          <td>1 vs 2+</td>
          <td>‚úÖ Validated</td>
      </tr>
      <tr>
          <td><strong>H3: Developer Experience</strong></td>
          <td>‚â§ 50% LoC</td>
          <td>47% (18 vs 38)</td>
          <td>‚úÖ Validated</td>
      </tr>
      <tr>
          <td><strong>H4: Consistency</strong></td>
          <td>0 partial saves</td>
          <td>0% vs 70%</td>
          <td>‚úÖ Validated</td>
      </tr>
  </tbody>
</table>
<p><strong>Hvad betyder dette samlet set?</strong></p>
<p>Resultaterne bekr√¶fter litteratur-evidensen fra research-fasen og demonstrerer at PostgreSQL&rsquo;s fordele holder i projektets konkrete kontekst. PostgreSQL leverer ikke kun bedre performance, men ogs√• simplere arkitektur (unified platform), hurtigere udvikling (standard patterns) og h√∏jere data-integritet (ACID guarantees).</p>
<p>MongoDB frav√¶lges definitivt baseret p√• consistent underperformance p√• alle metrics:</p>
<ul>
<li>26√ó d√•rligere JSON performance</li>
<li>Manglende native vector support</li>
<li>111% mere kode for samme features</li>
<li>70% data integrity failure ved crashes</li>
</ul>
<hr>
<h2 id="begr√¶nsninger-og-transparens">Begr√¶nsninger og Transparens<a hidden class="anchor" aria-hidden="true" href="#begr√¶nsninger-og-transparens">#</a></h2>
<p><strong>Denne test er ikke production-grade benchmarking:</strong></p>
<h3 id="reduceret-iteration-count">Reduceret iteration count<a hidden class="anchor" aria-hidden="true" href="#reduceret-iteration-count">#</a></h3>
<ul>
<li><strong>Hvad jeg gjorde:</strong> 10-20 iterations per test</li>
<li><strong>Production standard:</strong> 100+ iterations</li>
<li><strong>Impact:</strong> Lavere statistisk confidence, men sufficient for beslutningstagning</li>
</ul>
<h3 id="development-hardware">Development hardware<a hidden class="anchor" aria-hidden="true" href="#development-hardware">#</a></h3>
<ul>
<li><strong>Hvad jeg testede p√•:</strong> i5 laptop, 16GB RAM</li>
<li><strong>Production reality:</strong> Ofte lignende specs for small-scale deployments</li>
<li><strong>Impact:</strong> Resultater repr√¶senterer realistic deployment, ikke enterprise-scale</li>
</ul>
<h3 id="single-node-setup">Single-node setup<a hidden class="anchor" aria-hidden="true" href="#single-node-setup">#</a></h3>
<ul>
<li><strong>Hvad jeg testede:</strong> Lokale databaser uden replication</li>
<li><strong>Skipped:</strong> Distributed scenarios, network latency, multi-region</li>
<li><strong>Impact:</strong> Absolut tal ville √¶ndre sig, men relative forskelle holder</li>
</ul>
<h3 id="syntetisk-data">Syntetisk data<a hidden class="anchor" aria-hidden="true" href="#syntetisk-data">#</a></h3>
<ul>
<li><strong>Hvad jeg testede med:</strong> Genereret chatbot-data</li>
<li><strong>Reality:</strong> Actual user conversations har varierende patterns</li>
<li><strong>Impact:</strong> Patterns er realistic, men ikke exhaustive</li>
</ul>
<p><strong>Hvorfor disse begr√¶nsninger er acceptable:</strong></p>
<p>For et semester-projekt er form√•let at:</p>
<ol>
<li>Demonstrere metodologi</li>
<li>Indsamle indicative data</li>
<li>Tr√¶ffe informed beslutning</li>
</ol>
<p>Dette er opfyldt. Production deployment ville kr√¶ve mere omfattende validation, men for projektets scope er evidensen sufficient til at v√¶lge PostgreSQL med confidence.</p>
<hr>
<h2 id="implikationer-for-database-arkitektur">Implikationer for Database-Arkitektur<a hidden class="anchor" aria-hidden="true" href="#implikationer-for-database-arkitektur">#</a></h2>
<p>Testresultaterne etablerer clear design-direction:</p>
<p><strong>Definitive valg:</strong></p>
<ul>
<li>‚úÖ PostgreSQL som unified platform</li>
<li>‚úÖ pgvector for vector embeddings (eliminerer separat database)</li>
<li>‚ùå MongoDB frav√¶lges</li>
<li>‚ùå Dedikeret vector database (Pinecone/Weaviate) frav√¶lges</li>
</ul>
<p><strong>Arkitektoniske konsekvenser:</strong></p>
<ul>
<li>Single database system (reduceret operational complexity)</li>
<li>ACID transactions (garanteret data integrity)</li>
<li>Standard EF Core patterns (hurtigere development)</li>
<li>Native vector search (ingen sync-problemer)</li>
</ul>
<p><strong>Trade-offs accepteret:</strong></p>
<ul>
<li>PostgreSQL kr√¶ver mere initial setup end managed MongoDB Atlas</li>
<li>pgvector ~20% langsommere end dedikerede vector databases ved pure vector search</li>
<li>Men: For projektets use case (kombineret metadata+vector queries) er unified platform optimal</li>
</ul>
<p>N√¶ste fase dokumenterer den konkrete database-arkitektur der implementerer disse findings i chatbot-systemets tre komponenter (Guest, Authenticated, Owner).</p>
<hr>
<h2 id="n√¶ste-skridt-konkret-arkitektur">N√¶ste skridt: Konkret arkitektur<a hidden class="anchor" aria-hidden="true" href="#n√¶ste-skridt-konkret-arkitektur">#</a></h2>
<p>Nu skal testresultaterne oms√¶ttes til faktisk database-design. Hvordan struktureres tabeller? Hvilke indexes? Hvordan optimeres for hver chatbot-type?</p>
<p><em>Hvordan bygger vi systemet baseret p√• alt det vi har l√¶rt?</em></p>
<p><strong>N√¶ste:</strong> <a href="/datamatiker-portfolio/database/design/">Database Design ‚Üí</a></p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
    </ul>

  </footer>
</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2025 <a href="http://localhost:1313/datamatiker-portfolio/">4. Semester Portfolio - Simon</a></span> ¬∑ 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu');
    if (menu) {
        
        const scrollPosition = localStorage.getItem("menu-scroll-position");
        if (scrollPosition) {
            menu.scrollLeft = parseInt(scrollPosition, 10);
        }
        
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        const html = document.querySelector("html");
        if (html.dataset.theme === "dark") {
            html.dataset.theme = 'light';
            localStorage.setItem("pref-theme", 'light');
        } else {
            html.dataset.theme = 'dark';
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
