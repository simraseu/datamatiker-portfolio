<!DOCTYPE html>
<html lang="en" dir="auto" data-theme="light">

<head><script src="/datamatiker-portfolio/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=datamatiker-portfolio/livereload" data-no-instant defer></script><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="noindex, nofollow">
<title>Research | 4. Semester Portfolio - Simon</title>
<meta name="keywords" content="">
<meta name="description" content="Systematisk litteraturs√∏gning: Fra Google-frameworks til EU-lovgivning">
<meta name="author" content="Simon">
<link rel="canonical" href="http://localhost:1313/datamatiker-portfolio/data-science/research/">
<link crossorigin="anonymous" href="/datamatiker-portfolio/assets/css/stylesheet.fd5566c526ae48aadabd950798a2dc3568536401560eae5caac3765a42a9e7b5.css" integrity="sha256-/VVmxSauSKravZUHmKLcNWhTZAFWDq5cqsN2WkKp57U=" rel="preload stylesheet" as="style">
<link rel="icon" href="http://localhost:1313/datamatiker-portfolio/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="http://localhost:1313/datamatiker-portfolio/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="http://localhost:1313/datamatiker-portfolio/favicon-32x32.png">
<link rel="apple-touch-icon" href="http://localhost:1313/datamatiker-portfolio/apple-touch-icon.png">
<link rel="mask-icon" href="http://localhost:1313/datamatiker-portfolio/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="http://localhost:1313/datamatiker-portfolio/data-science/research/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
</noscript>
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.querySelector("html").dataset.theme = 'dark';
    }

</script>
</head>
<body id="top">
    <header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="http://localhost:1313/datamatiker-portfolio/" accesskey="h" title="4. Semester Portfolio - Simon (Alt + H)">4. Semester Portfolio - Simon</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)" aria-label="Toggle theme">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="http://localhost:1313/datamatiker-portfolio/" title="Forside">
                    <span>Forside</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/datamatiker-portfolio/om-projektet/" title="Om Projektet">
                    <span>Om Projektet</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/datamatiker-portfolio/laeringsmaal/" title="L√¶ringsm√•l">
                    <span>L√¶ringsm√•l</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/datamatiker-portfolio/database/" title="Database &amp; Storage">
                    <span>Database &amp; Storage</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/datamatiker-portfolio/data-science/" title="Data Science &amp; Analytics">
                    <span>Data Science &amp; Analytics</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/datamatiker-portfolio/vidensrejse/" title="Vidensrejse">
                    <span>Vidensrejse</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/datamatiker-portfolio/refleksion/" title="Samlet Refleksion">
                    <span>Samlet Refleksion</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="http://localhost:1313/datamatiker-portfolio/">Home</a>&nbsp;¬ª&nbsp;<a href="http://localhost:1313/datamatiker-portfolio/data-science/">Data Science &amp; Analytics</a></div>
    <h1 class="post-title entry-hint-parent">
      Research
    </h1>
    <div class="post-description">
      Systematisk litteraturs√∏gning: Fra Google-frameworks til EU-lovgivning
    </div>
    <div class="post-meta"><span>Simon</span>

</div>
  </header> <div class="toc">
    <details  open>
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#hvor-finder-man-opskriften-p%c3%a5-etisk-analytics" aria-label="Hvor finder man opskriften p√• ‚Äúetisk analytics‚Äù?">Hvor finder man opskriften p√• ‚Äúetisk analytics‚Äù?</a></li>
                <li>
                    <a href="#strategi-og-metodologi" aria-label="Strategi og Metodologi">Strategi og Metodologi</a><ul>
                        
                <li>
                    <a href="#inklusionskriterier" aria-label="Inklusionskriterier">Inklusionskriterier</a></li></ul>
                </li>
                <li>
                    <a href="#evidence-summary-table" aria-label="Evidence Summary Table">Evidence Summary Table</a></li>
                <li>
                    <a href="#de-fem-kilder-i-dybden" aria-label="De fem kilder i dybden">De fem kilder i dybden</a></li>
                <li>
                    <a href="#1-google-heart-framework-ux" aria-label="1. Google HEART Framework (UX)">1. Google HEART Framework (UX)</a></li>
                <li>
                    <a href="#2-aarrr-pirate-metrics-business" aria-label="2. AARRR Pirate Metrics (Business)">2. AARRR Pirate Metrics (Business)</a></li>
                <li>
                    <a href="#3-gdpr-art-9--25-privacy" aria-label="3. GDPR Art. 9 &amp; 25 (Privacy)">3. GDPR Art. 9 &amp; 25 (Privacy)</a></li>
                <li>
                    <a href="#4-designing-data-intensive-applications-arkitektur" aria-label="4. Designing Data-Intensive Applications (Arkitektur)">4. Designing Data-Intensive Applications (Arkitektur)</a></li>
                <li>
                    <a href="#5-goodharts-law-kritisk-metrik-teori" aria-label="5. Goodhart‚Äôs Law (Kritisk Metrik-teori)">5. Goodhart‚Äôs Law (Kritisk Metrik-teori)</a></li>
                <li>
                    <a href="#samlet-analyse-fra-teori-til-design-patterns" aria-label="Samlet Analyse: Fra teori til Design Patterns">Samlet Analyse: Fra teori til Design Patterns</a>
                </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><h2 id="hvor-finder-man-opskriften-p√•-etisk-analytics">Hvor finder man opskriften p√• ‚Äúetisk analytics‚Äù?<a hidden class="anchor" aria-hidden="true" href="#hvor-finder-man-opskriften-p√•-etisk-analytics">#</a></h2>
<p>I problemstillingen identificerede jeg tre centrale dilemmaer:</p>
<ul>
<li>Vanity metrics</li>
<li>Privacy-paradokset</li>
<li>Arkitektur-konflikten</li>
</ul>
<p>For at l√∏se dem kunne jeg ikke g√¶tte eller kopiere ‚Äúbest practices‚Äù. Jeg havde brug for <strong>evidens</strong>, dokumenteret i b√•de forskning, lovgivning og moderne data-arkitektur.</p>
<p>Min research fokuserede derfor p√• fire kernesp√∏rgsm√•l:</p>
<ol>
<li><strong>KPI Design:</strong> Hvordan m√•ler store virksomheder succes uden vanity metrics?</li>
<li><strong>Privacy:</strong> Hvad kr√¶ver GDPR <em>konkret</em> af arkitektur og logging?</li>
<li><strong>Arkitektur:</strong> Hvordan forener man real-time overv√•gning med tung historisk analyse?</li>
<li><strong>Validering:</strong> Hvordan undg√•r jeg at KPI‚Äôer bliver misvisende eller skadelige?</li>
</ol>
<hr>
<h2 id="strategi-og-metodologi">Strategi og Metodologi<a hidden class="anchor" aria-hidden="true" href="#strategi-og-metodologi">#</a></h2>
<p>Jeg anvendte <strong>metodisk triangulering</strong>, hvor fem uafh√¶ngige dom√¶ner unders√∏ges, og f√¶lles l√∏sninger identificeres. N√•r teori, lovgivning og industry best practices peger i samme retning, opst√•r <strong>convergent validity</strong>.</p>
<h3 id="inklusionskriterier">Inklusionskriterier<a hidden class="anchor" aria-hidden="true" href="#inklusionskriterier">#</a></h3>
<p><strong>Accept√©r kilde hvis:</strong></p>
<ul>
<li>Peer-reviewed forskning (&gt;100 citationer)</li>
<li>EU-regulation eller officiel guideline</li>
<li>Teknisk reference fra anerkendt autoritet (O‚ÄôReilly, ACM)</li>
<li>Industrirapporter med dokumenterede cases (Amplitude, Stripe)</li>
</ul>
<p><strong>Eksklud√©r kilde hvis:</strong></p>
<ul>
<li>Vendor marketing</li>
<li>Blog posts uden citations</li>
<li>‚ÄúBest practice‚Äù-artikler uden empirisk evidens</li>
<li>For√¶ldede eller biased whitepapers</li>
</ul>
<p>Denne metodiske filtrering reducerede st√∏j og sikrede, at Design Patterns bygger p√• solid evidens, ikke subjektive meninger.</p>
<hr>
<h2 id="evidence-summary-table">Evidence Summary Table<a hidden class="anchor" aria-hidden="true" href="#evidence-summary-table">#</a></h2>
<table>
  <thead>
      <tr>
          <th style="text-align: left">Dom√¶ne</th>
          <th style="text-align: left">Kilde</th>
          <th style="text-align: left">Main Finding</th>
          <th style="text-align: left">Anvendelse</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left"><strong>UX Metrics</strong></td>
          <td style="text-align: left">Google HEART</td>
          <td style="text-align: left">5-delt UX-framework (Happiness, Engagement, etc.)</td>
          <td style="text-align: left">Metric Hierarchy (DP1)</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>Business</strong></td>
          <td style="text-align: left">AARRR Pirate Metrics</td>
          <td style="text-align: left">Funnel til at m√•le produktets sundhed</td>
          <td style="text-align: left">Owner Dashboard (DP1/DP4)</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>Legal</strong></td>
          <td style="text-align: left">GDPR Art. 9 &amp; 25</td>
          <td style="text-align: left">Privacy by Design, data minimization</td>
          <td style="text-align: left">Privacy-First Logging (DP2)</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>Arkitektur</strong></td>
          <td style="text-align: left">Kleppmann: DDIA</td>
          <td style="text-align: left">Lambda Architecture (Hot/Cold paths)</td>
          <td style="text-align: left">Dual-Speed Analytics (DP3)</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>Kritisk Teori</strong></td>
          <td style="text-align: left">Goodhart‚Äôs Law</td>
          <td style="text-align: left">Metrikker mister v√¶rdi n√•r de bliver m√•l</td>
          <td style="text-align: left">KPI Audit Framework (DP4)</td>
      </tr>
  </tbody>
</table>
<hr>
<h2 id="de-fem-kilder-i-dybden">De fem kilder i dybden<a hidden class="anchor" aria-hidden="true" href="#de-fem-kilder-i-dybden">#</a></h2>
<h2 id="1-google-heart-framework-ux">1. Google HEART Framework (UX)<a hidden class="anchor" aria-hidden="true" href="#1-google-heart-framework-ux">#</a></h2>
<p><strong>Reference:</strong> Rodden et al. (2010), Google Research<sup id="fnref:1"><a href="#fn:1" class="footnote-ref" role="doc-noteref">1</a></sup>.</p>
<p><strong>Hvorfor denne kilde?</strong><br>
Chatbots fungerer dialogisk ‚Äì ikke som websites. HEART m√•ler samtalekvalitet, ikke kun aktivitet.</p>
<details>
<summary><strong>üîç Detaljer & Relevans</strong></summary>
<p><strong>HEART best√•r af:</strong></p>
<ul>
<li>Happiness</li>
<li>Engagement</li>
<li>Adoption</li>
<li>Retention</li>
<li>Task Success</li>
</ul>
<p><strong>Relevans:</strong></p>
<ul>
<li><em>Guest Chatbot:</em> Task Success er centrale</li>
<li><em>Authenticated:</em> Retention + Task Success</li>
<li><em>Owner:</em> Adoption &amp; Retention p√• systemniveau</li>
</ul>
<p>HEART danner √∏verste del af min <strong>Layered Metrics Pyramid</strong>.</p>
</details>
<hr>
<h2 id="2-aarrr-pirate-metrics-business">2. AARRR Pirate Metrics (Business)<a hidden class="anchor" aria-hidden="true" href="#2-aarrr-pirate-metrics-business">#</a></h2>
<p><strong>Reference:</strong> McClure (2007)<sup id="fnref:2"><a href="#fn:2" class="footnote-ref" role="doc-noteref">2</a></sup>.</p>
<p><strong>Hvorfor denne kilde?</strong><br>
Owner Dashboard skal m√•le forretningsv√¶rdi, ikke trafikvolumen.</p>
<details>
<summary><strong>üîç Detaljer & Relevans</strong></summary>
<p><strong>AARRR best√•r af:</strong></p>
<ul>
<li>Acquisition</li>
<li>Activation</li>
<li>Retention</li>
<li>Referral</li>
<li>Revenue</li>
</ul>
<p><strong>Relevans:</strong><br>
Tvinger Owner Dashboard v√¶k fra ‚ÄúTotal Users‚Äù vanity metrics og over mod:</p>
<ul>
<li>Aktivationsrate</li>
<li>Fastholdelse</li>
<li>Token-effektivitet</li>
</ul>
</details>
<hr>
<h2 id="3-gdpr-art-9--25-privacy">3. GDPR Art. 9 &amp; 25 (Privacy)<a hidden class="anchor" aria-hidden="true" href="#3-gdpr-art-9--25-privacy">#</a></h2>
<p><strong>Reference:</strong> EU GDPR (2016)<sup id="fnref:3"><a href="#fn:3" class="footnote-ref" role="doc-noteref">3</a></sup>.</p>
<p><strong>Hvorfor denne kilde?</strong><br>
Den afg√∏r hvad jeg <em>m√•</em> logge ‚Äì ikke bare hvad der er smart at logge.</p>
<details>
<summary><strong>üîç Detaljer & Relevans</strong></summary>
<p><strong>Art. 9:</strong> Forbud mod behandling af helbredsdata uden eksplicit samtykke.<br>
<strong>Art. 25:</strong> Privacy by Design ‚Üí Data Minimization.</p>
<p><strong>Relevans for min arkitektur:</strong></p>
<ul>
<li>Raw text kan ikke gemmes</li>
<li>UserID m√• ikke lagres i klartekst</li>
<li>Logging skal ske som:<br>
<code>IntentCategory + SessionHash</code></li>
</ul>
<p>Dette er fundamentet for <strong>DP2: Privacy-First Logging</strong>.</p>
</details>
<hr>
<h2 id="4-designing-data-intensive-applications-arkitektur">4. Designing Data-Intensive Applications (Arkitektur)<a hidden class="anchor" aria-hidden="true" href="#4-designing-data-intensive-applications-arkitektur">#</a></h2>
<p><strong>Reference:</strong> Kleppmann (2017)<sup id="fnref:4"><a href="#fn:4" class="footnote-ref" role="doc-noteref">4</a></sup>.</p>
<p><strong>Hvorfor denne kilde?</strong><br>
L√∏ser konflikten mellem real-time drift og historiske analyser.</p>
<details>
<summary><strong>üîç Detaljer & Relevans</strong></summary>
<p><strong>Lambda Architecture:</strong></p>
<ul>
<li><strong>Hot Path:</strong> Real-time ‚Üí hurtige alarmer</li>
<li><strong>Cold Path:</strong> Batch ‚Üí tunge beregninger</li>
</ul>
<p><strong>Relevans:</strong><br>
Chatbotten kr√¶ver:</p>
<ul>
<li>real-time error alerts (Owner)</li>
<li>ugentlige retention-udregninger (Product)</li>
</ul>
<p>Det implementeres som <strong>DP3: Dual-Speed Analytics</strong>.</p>
</details>
<hr>
<h2 id="5-goodharts-law-kritisk-metrik-teori">5. Goodhart‚Äôs Law (Kritisk Metrik-teori)<a hidden class="anchor" aria-hidden="true" href="#5-goodharts-law-kritisk-metrik-teori">#</a></h2>
<p><strong>Reference:</strong> Strathern (1997)<sup id="fnref:5"><a href="#fn:5" class="footnote-ref" role="doc-noteref">5</a></sup>.</p>
<p><strong>Hvorfor denne kilde?</strong><br>
Den afsl√∏rer hvorn√•r en KPI bliver skadelig.</p>
<details>
<summary><strong>üîç Detaljer & Relevans</strong></summary>
<p><strong>Audit-sp√∏rgsm√•l:</strong></p>
<ol>
<li>Vil optimering mod denne metric skade brugeren?</li>
<li>Kan metric‚Äôen gamificeres af systemet?</li>
<li>B√∏r den parres med en kvalitativ kontrolm√•ling?</li>
</ol>
<p><strong>Eksempler:</strong></p>
<ul>
<li>‚ÄúF√• beskeder per session‚Äù ‚Üí Gode svar? eller ultrakort bot?</li>
<li>‚ÄúSession duration‚Äù ‚Üí L√¶ring? eller frustration?</li>
</ul>
<p>Dette bruges i <strong>DP4: Context-Aware KPIs</strong>.</p>
</details>
<hr>
<h2 id="samlet-analyse-fra-teori-til-design-patterns">Samlet Analyse: Fra teori til Design Patterns<a hidden class="anchor" aria-hidden="true" href="#samlet-analyse-fra-teori-til-design-patterns">#</a></h2>
<p>De fem kilder peger p√• √©n samlet, konsistent l√∏sning. Deres roller fremg√•r i tabellen:</p>
<table>
  <thead>
      <tr>
          <th>Research Source</th>
          <th>Design Pattern</th>
          <th>Funktion</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>HEART + AARRR</td>
          <td><strong>DP1: Layered Metrics Pyramid</strong></td>
          <td>Definerer KPI-struktur for Guest/Auth/Owner</td>
      </tr>
      <tr>
          <td>GDPR Art. 25</td>
          <td><strong>DP2: Privacy-First Logging</strong></td>
          <td>Logging uden raw text, hashing ved kilden</td>
      </tr>
      <tr>
          <td>Kleppmann</td>
          <td><strong>DP3: Dual-Speed Analytics</strong></td>
          <td>Hot Path + Cold Path</td>
      </tr>
      <tr>
          <td>Goodhart&rsquo;s Law</td>
          <td><strong>DP4: Context-Aware KPIs</strong></td>
          <td>KPI-audit, undg√•r metric-fejl</td>
      </tr>
  </tbody>
</table>
<p>Gennem trianguleringen beh√∏ver jeg ikke l√¶ngere g√¶tte.<br>
Jeg kan nu formulere fire evidensbaserede <strong>Design Patterns</strong>, der l√∏ser problemstillingens dilemmaer med faglig tyngde.</p>
<hr>
<p><strong>N√¶ste:</strong> <a href="/datamatiker-portfolio/data-science/design-patterns/">Design Patterns ‚Üí</a></p>
<div class="footnotes" role="doc-endnotes">
<hr>
<ol>
<li id="fn:1">
<p>Rodden, K., Hutchinson, H., &amp; Fu, X. (2010). &ldquo;Measuring the User Experience on a Large Scale&rdquo;. Google Research.&#160;<a href="#fnref:1" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:2">
<p>McClure, D. (2007). &ldquo;Startup Metrics for Pirates: AARRR!&rdquo;.&#160;<a href="#fnref:2" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:3">
<p>EU GDPR (2016). Articles 9 &amp; 25.&#160;<a href="#fnref:3" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:4">
<p>Kleppmann, M. (2017). &ldquo;Designing Data-Intensive Applications&rdquo;. O‚ÄôReilly.&#160;<a href="#fnref:4" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:5">
<p>Strathern, M. (1997). ‚ÄúImproving ratings‚Äù. European Review.&#160;<a href="#fnref:5" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
</ol>
</div>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
    </ul>

  </footer>
</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2025 <a href="http://localhost:1313/datamatiker-portfolio/">4. Semester Portfolio - Simon</a></span> ¬∑ 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu');
    if (menu) {
        
        const scrollPosition = localStorage.getItem("menu-scroll-position");
        if (scrollPosition) {
            menu.scrollLeft = parseInt(scrollPosition, 10);
        }
        
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        const html = document.querySelector("html");
        if (html.dataset.theme === "dark") {
            html.dataset.theme = 'light';
            localStorage.setItem("pref-theme", 'light');
        } else {
            html.dataset.theme = 'dark';
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
